# AlphaIntelligence - Full Codebase Documentation (File-by-File)

This document was generated by reading every code file in the repository and summarizing responsibilities, key symbols, and execution role.

- Total code files documented: **94**
- Included extensions: `.py`, `.sh`, `.bat`, `.yml`, `.yaml`

## System overview

- **Daily momentum system**: orchestrated primarily by `run_optimized_scan.py` with modules in `src/data`, `src/screening`, `src/reporting`, and `src/notifications`.
- **Quarterly compounder system**: orchestrated by `run_quarterly_compounder_scan.py` with modules in `src/long_term` plus shared data/reporting layers.
- **Persistence**: SQLAlchemy-backed models in `src/data/storage.py` and `src/database/db_manager.py`, plus local cache artifacts.
- **Automation**: GitHub Actions workflows in `.github/workflows/` run scheduled scans, portfolio operations, and quarterly reporting.

## File-by-file reference

### Top-level automation & scripts

- **`automated_position_report.py`** (80 lines): Automated position reporting - runs as part of GitHub Actions workflow.
- **`check_positions.py`** (78 lines): Quick script to check your current portfolio positions.
  - Functions: main
- **`check_throttling.sh`** (101 lines): Shell helper to test API throttling behavior and safe request rates.
- **`comprehensive_system_test.py`** (175 lines): Comprehensive System Test Runner.
  - Functions: run_test
- **`daily_scanner.sh`** (38 lines): Shell wrapper to execute the daily scanner workflow locally.
- **`dashboard.py`** (151 lines): No module docstring; utility/support file.
  - Functions: get_universe_signals, get_portfolio_data, load_reports
- **`demo.py`** (91 lines): Demo script showing the stock screener in action.
  - Functions: main
- **`evaluate_portfolio.py`** (87 lines): No module docstring; utility/support file.
  - Functions: evaluate_portfolio
- **`init_db.py`** (17 lines): No module docstring; utility/support file.
  - Functions: init_db
- **`manage_positions.py`** (124 lines): Position management tool - integrates local positions with stop loss recommendations.
  - Functions: main
- **`quality_check_demo.py`** (242 lines): Demonstration of the data quality validation system.
  - Functions: print_separator, run_quality_checks, check_single_ticker, main
- **`run_ai_report.py`** (87 lines): Generates a deep-dive Quantitative Intelligence Report using AI.
  - Functions: generate_deep_dive
- **`run_daily_scan.bat`** (67 lines): @echo off
- **`run_full_market_scan.py`** (394 lines): Full market scanner for ALL publicly traded US stocks.
  - Functions: save_daily_report, main
- **`run_optimized_scan.py`** (826 lines): Optimized full market scanner with parallel processing.
  - Functions: save_report, run_etf_scan, main
- **`run_quant_engine.py`** (146 lines): Run the Quant Analysis & Execution Engine.
  - Functions: load_config, save_results, main
- **`run_quarterly_compounder_scan.py`** (820 lines): Quarterly Compounder Scan - Main Entry Point.
  - Classes: QuarterlyCompounderScan | Functions: main
- **`run_screen.sh`** (6 lines): Minimal shell entrypoint for running screen commands.
- **`run_test.sh`** (6 lines): Minimal shell entrypoint for running test commands.
- **`screening_demo.py`** (289 lines): Demonstration of the stock screening module.
  - Functions: print_separator, fetch_sample_data, run_screening, display_results, display_detailed_analysis, main
- **`seed_db.py`** (44 lines): No module docstring; utility/support file.
  - Functions: seed_data

### Top-level tests & diagnostics

- **`test_ai.py`** (41 lines): No module docstring; utility/support file.
  - Functions: test_ai
- **`test_email_full.py`** (60 lines): Test script to fetch data, screen stocks, and send email notification.
- **`test_enhanced_fundamentals.py`** (111 lines): Test script for enhanced fundamentals integration.
  - Functions: main
- **`test_etf_discovery.py`** (225 lines): Test script for ETF Universe Discovery.
  - Functions: test_etf_discovery
- **`test_etf_scoring.py`** (200 lines): Test script for ETF Engine.
  - Functions: test_etf_engine
- **`test_fmp_debug.py`** (27 lines): No module docstring; utility/support file.
  - Functions: test_fmp
- **`test_fmp_direct.py`** (22 lines): No module docstring; utility/support file.
  - Functions: test_fmp_direct
- **`test_fmp_multi.py`** (35 lines): No module docstring; utility/support file.
  - Functions: test_fmp_v3
- **`test_fmp_v2.py`** (27 lines): No module docstring; utility/support file.
  - Functions: test
- **`test_git_storage_fetcher.py`** (197 lines): Test script for GitStorageFetcher - demonstrates Git-based storage.
  - Functions: main
- **`test_long_term_data.py`** (133 lines): Test script for long-term fundamentals data fetcher.
  - Functions: test_data_fetcher
- **`test_long_term_imports.py`** (111 lines): Verify long-term module structure and imports.
  - Functions: test_imports
- **`test_portfolio_construction.py`** (237 lines): Test script for Portfolio Constructor.
  - Functions: test_portfolio_construction
- **`test_quant_engine.py`** (39 lines): Quick test of the Quant Analysis Engine with a small set of stocks.
  - Functions: main
- **`test_report_generation.py`** (273 lines): Test script for Report Generator.
  - Functions: test_report_generation
- **`test_sec_debug.py`** (23 lines): No module docstring; utility/support file.
  - Functions: test_sec
- **`test_smart_fetcher.py`** (151 lines): Test script for SmartDataFetcher to demonstrate savings.
  - Functions: main

### Core package: src/

- **`src/__init__.py`** (3 lines): Stock screener package for identifying undervalued stocks near support levels.
- **`src/ai/__init__.py`** (1 lines): No module docstring; utility/support file.
- **`src/ai/ai_agent.py`** (136 lines): AI Analysis Engine using NVIDIA NIM for elite financial commentary.
  - Classes: AIAgent
- **`src/analysis/__init__.py`** (0 lines): No module docstring; utility/support file.
- **`src/analysis/position_manager.py`** (567 lines): Position management and stop loss recommendations.
  - Classes: PositionManager | Functions: main
- **`src/data/__init__.py`** (14 lines): Data fetching and storage modules for stock screener.
- **`src/data/enhanced_fundamentals.py`** (367 lines): Enhanced fundamentals wrapper that intelligently uses FMP + yfinance.
  - Classes: EnhancedFundamentalsFetcher
- **`src/data/fetcher.py`** (393 lines): Data fetching module for retrieving stock data from Yahoo Finance.
  - Classes: YahooFinanceFetcher
- **`src/data/finnhub_fetcher.py`** (249 lines): Finnhub API fetcher for market data, crypto, forex, and news.
  - Classes: FinnhubFetcher
- **`src/data/fmp_fetcher.py`** (667 lines): Financial Modeling Prep (FMP) API fetcher for detailed quarterly fundamentals.
  - Classes: FMPFetcher
- **`src/data/fundamentals_fetcher.py`** (442 lines): Enhanced fundamentals fetcher for quarterly financial data.
  - Functions: fetch_quarterly_financials, create_fundamental_snapshot, analyze_fundamentals_for_signal
- **`src/data/git_storage_fetcher.py`** (347 lines): Smart fetcher using Git-based storage for fundamentals and fresh price data.
  - Classes: GitStorageFetcher
- **`src/data/quality.py`** (621 lines): Data quality validation and monitoring for stock data.
  - Classes: IssueSeverity, DataQualityIssue, TickerQualityReport, DataQualityChecker
- **`src/data/sec_fetcher.py`** (68 lines): No module docstring; utility/support file.
  - Classes: SECFetcher
- **`src/data/smart_fetcher.py`** (347 lines): Smart data fetcher with incremental updates and earnings-aware caching.
  - Classes: SmartDataFetcher
- **`src/data/storage.py`** (648 lines): Database storage module for stock data using SQLAlchemy.
  - Classes: Stock, Fundamental, PriceHistory, DataQualityLog, StockDatabase
- **`src/data/universe_fetcher.py`** (222 lines): Fetch and maintain the universe of all publicly traded US stocks.
  - Classes: USStockUniverseFetcher
- **`src/data/yfinance_positions.py`** (241 lines): Local position fetcher using YFinance for prices.
  - Classes: YFinancePositionFetcher | Functions: main
- **`src/database/__init__.py`** (1 lines): No module docstring; utility/support file.
- **`src/database/db_manager.py`** (356 lines): Database management for users and newsletter subscribers using SQLAlchemy and Neon Postgres.
  - Classes: Subscriber, Recommendation, PortfolioHolding, TradeRecord, DailyPerformance, AllocationPlan â€¦
- **`src/long_term/__init__.py`** (22 lines): Long-Term Compounder Identification System
- **`src/long_term/compounder_engine.py`** (421 lines): Long-term compounder identification engine.
  - Classes: CompounderScore, CompounderEngine
- **`src/long_term/concentration_rules.py`** (372 lines): Concentration Rules Engine.
  - Classes: ConcentrationRules, ConstraintValidator, AllocationOptimizer
- **`src/long_term/data_fetcher.py`** (484 lines): Long-term fundamentals data fetcher.
  - Classes: LongTermFundamentals, LongTermFundamentalsFetcher
- **`src/long_term/etf_engine.py`** (359 lines): ETF Scoring Engine for Thematic Identification.
  - Classes: ETFScore, ETFEngine
- **`src/long_term/etf_universe.py`** (430 lines): ETF Universe Discovery and Filtering.
  - Classes: ETFMetadata, ETFUniverse
- **`src/long_term/metrics.py`** (383 lines): Long-term metric calculations for compounder identification.
  - Classes: MetricsCalculator
- **`src/long_term/moat_scoring.py`** (185 lines): Business moat signal scoring.
  - Classes: MoatScorer
- **`src/long_term/portfolio_constructor.py`** (311 lines): Portfolio Constructor.
  - Classes: PortfolioAllocation, PortfolioConstructor
- **`src/long_term/regime_classifier.py`** (239 lines): Long-cycle regime classifier.
  - Classes: Regime, RegimeClassifier
- **`src/long_term/report_generator.py`** (470 lines): Report Generator for Quarterly Ownership Reports.
  - Classes: InvalidationTrigger, AssetThesis, InvalidationTracker, ReportGenerator
- **`src/notifications/__init__.py`** (1 lines): Notifications module for email and alerts.
- **`src/notifications/email_notifier.py`** (436 lines): Email notification system for sending newsletters and alerts.
  - Classes: EmailNotifier
- **`src/notifications/scheduler.py`** (343 lines): Scheduling module for automated stock screening and notifications.
  - Classes: ScreeningScheduler | Functions: main
- **`src/notifications/slack_notifier.py`** (308 lines): Slack notification module for sending screening alerts.
  - Classes: SlackNotifier
- **`src/reporting/__init__.py`** (1 lines): Reporting module for generating newsletters and reports.
- **`src/reporting/newsletter_generator.py`** (335 lines): No module docstring; utility/support file.
  - Classes: NewsletterGenerator
- **`src/reporting/portfolio_manager.py`** (351 lines): Portfolio Management and Advanced Reporting Engine.
  - Classes: PortfolioManager
- **`src/screening/__init__.py`** (27 lines): Stock screening module for identifying undervalued stocks at support levels.
- **`src/screening/batch_processor.py`** (353 lines): Batch processor for screening large numbers of stocks with rate limiting.
  - Classes: BatchStockProcessor
- **`src/screening/benchmark.py`** (299 lines): Benchmark and market breadth analysis module.
  - Functions: analyze_spy_trend, calculate_market_breadth, classify_market_regime, format_benchmark_summary, should_generate_signals
- **`src/screening/indicators.py`** (358 lines): Technical indicators module for stock analysis.
  - Functions: calculate_rsi, calculate_sma, calculate_ema, find_swing_lows, detect_volume_spike, calculate_support_strength, calculate_bollinger_bands, calculate_macd â€¦
- **`src/screening/optimized_batch_processor.py`** (504 lines): Optimized batch processor with parallel processing and adaptive rate limiting.
  - Classes: OptimizedBatchProcessor
- **`src/screening/phase_indicators.py`** (884 lines): Phase-based technical indicators for the Quant Analysis Engine.
  - Functions: calculate_sma, calculate_slope, calculate_relative_strength, calculate_rs_slope, detect_volatility_contraction, find_base_high, find_pivot_high, calculate_volume_ratio â€¦
- **`src/screening/quant_engine.py`** (350 lines): Main Quant Analysis & Execution Engine.
  - Classes: QuantAnalysisEngine
- **`src/screening/screener.py`** (533 lines): Stock screening module for identifying undervalued stocks at support levels.
  - Functions: calculate_value_score, detect_support_levels, calculate_support_score, screen_candidates
- **`src/screening/signal_engine.py`** (925 lines): Signal detection and scoring engine for buy/sell decisions.
  - Functions: calculate_stop_loss, score_buy_signal, score_sell_signal, format_signal_output

### Test package: tests/

- **`tests/__init__.py`** (1 lines): Test suite for stock screener.
- **`tests/test_fetcher.py`** (510 lines): Comprehensive test suite for YahooFinanceFetcher.
  - Classes: TestYahooFinanceFetcherInit, TestFetchFundamentals, TestFetchPriceHistory, TestFetchMultiple, TestCacheManagement, TestErrorHandling | Functions: temp_cache_dir, fetcher, mock_stock_info, mock_price_history
- **`tests/test_quality.py`** (563 lines): Tests for data quality validation module.
  - Classes: TestDataQualityIssue, TestTickerQualityReport, TestFreshnessChecks, TestCompletenessChecks, TestAnomalyDetection, TestQualityScoring â€¦ | Functions: mock_db, quality_checker, fresh_fundamentals, stale_fundamentals, fresh_price_history, stale_price_history
- **`tests/test_screener.py`** (523 lines): Comprehensive test suite for stock screening module.
  - Classes: TestValueScoring, TestSupportDetection, TestSupportScoring, TestTechnicalIndicators, TestScreenCandidates, TestEdgeCases

### CI workflows

- **`.github/workflows/daily_portfolio_operations.yml`** (72 lines): GitHub Actions workflow: ðŸ“ˆ Daily Portfolio Operations
- **`.github/workflows/daily_scan_with_email.yml`** (106 lines): GitHub Actions workflow: ðŸ“ˆ Daily Market Scan & Newsletter
- **`.github/workflows/daily_screening_git_storage.yml`** (50 lines): GitHub Actions workflow: ðŸ“‚ Daily Data Persistence & Growth Scan
- **`.github/workflows/quarterly_compounder_scan.yml`** (190 lines): GitHub Actions workflow: Quarterly Compounder Scan

### Configuration

- **`config.yaml`** (77 lines): # Quant Analysis Engine Configuration

## Notes for maintainers

- If you add new runnable scripts or modules, append them to this document with a one-line purpose and key symbols.
- Keep this file synchronized with `README.md` and `SYSTEM_OVERVIEW.md` when architecture changes.

